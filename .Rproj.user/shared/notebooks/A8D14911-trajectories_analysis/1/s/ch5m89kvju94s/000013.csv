"0","# now same code but we focus on responses: Reflect and Lure"
"0","# --------------------------------------------------------------------"
"0","# Filter for specific responses"
"0","# --------------------------------------------------------------------"
"0",""
"0","filtered_df <- results_df %>%"
"0","  filter(response %in% c(""Reflect"", ""Lure""))"
"0",""
"0",""
"0","# --------------------------------------------------------------------"
"0","# Aggregate Mean Trajectories per Word Position by Response"
"0","# --------------------------------------------------------------------"
"0","mean_trajectory_resp <- filtered_df %>%"
"0","  group_by(response, deliberation_function, start_word) %>%"
"0","  summarise(similarity = mean(similarity, na.rm = TRUE)) %>%"
"0","  rename(position = start_word)"
"2","`summarise()` has grouped output by 'response', 'deliberation_function'. You can override using the `.groups` argument."
"0","# --------------------------------------------------------------------"
"0","## Aggregate Mean Trajectories per Normalized Position by Response"
"0","# --------------------------------------------------------------------"
"0",""
"0","mean_trajectory_norm_resp <- filtered_df %>%"
"0","  group_by(response, deliberation_function, normalized_position) %>%"
"0","  summarise(similarity = mean(similarity, na.rm = TRUE)) %>%"
"0","  rename(position = normalized_position)"
"2","`summarise()` has grouped output by 'response', 'deliberation_function'. You can override using the `.groups` argument."
"0","# --------------------------------------------------------------------"
"0","# Smoothing Function for Response Grouping"
"0",""
"0","# --------------------------------------------------------------------"
"0","smooth_trajectory_response <- function(df, window = 5) {"
"0","  df %>%"
"0","    group_by(response, deliberation_function) %>%"
"0","    arrange(position) %>%"
"0","    mutate(similarity = rollmean(similarity, k = window, fill = NA, align = ""center"")) %>%"
"0","    drop_na()"
"0","}"
"0",""
"0","# --------------------------------------------------------------------"
"0","# Plot Per-Word Position Trajectory by Response (All Functions Together)"
"0","# --------------------------------------------------------------------"
"0","smoothed_resp <- smooth_trajectory_response(mean_trajectory_resp, window = 5)"
"0",""
"0","ggplot(smoothed_resp, aes(x = position, y = similarity, color = deliberation_function)) +"
"0","  geom_line(size = 1) +"
"0","  facet_wrap(~response, scales = ""free_y"") +"
"0","  theme_minimal() +"
"0","  labs(x = ""Position in Transcription (Words)"","
"0","       y = ""Mean Similarity"","
"0","       title = ""Mean Activation Trajectory per Function (Words) by Response"")"
