"0","library(corrr)   # For clean correlation tables & plots (optional)"
"0",""
"0","# --------------------------------------------------------------------"
"0","# Pivot Wider: Functions as Columns"
"0","# --------------------------------------------------------------------"
"0","cor_data <- results_df %>%"
"0","  select(subject_id, question, start_word, deliberation_function, similarity) %>%"
"0","  pivot_wider("
"0","    names_from = deliberation_function,"
"0","    values_from = similarity"
"0","  )"
"0",""
"0","# --------------------------------------------------------------------"
"0","# Compute Correlation Matrix"
"0","# --------------------------------------------------------------------"
"0","# Remove missing values (you could also use pairwise.complete.obs)"
"0","cor_matrix <- cor("
"0","  cor_data %>% select(-subject_id, -question, -start_word),"
"0","  use = ""pairwise.complete.obs"","
"0","  method = ""pearson"""
"0",")"
"0",""
"0","print(cor_matrix)"
"1","             "
"1","   control"
"1"," generation"
"1"," justification"
"1"," regulation"
"1","
control      "
"1"," 1.0000000"
"1","  0.6084712"
"1","     0.5620520"
"1","  0.8083567"
"1","
generation   "
"1"," 0.6084712"
"1","  1.0000000"
"1","     0.7343998"
"1","  0.7334274"
"1","
justification"
"1"," 0.5620520"
"1","  0.7343998"
"1","     1.0000000"
"1","  0.6880054"
"1","
regulation   "
"1"," 0.8083567"
"1","  0.7334274"
"1","     0.6880054"
"1","  1.0000000"
"1","
"
"0","# --------------------------------------------------------------------"
"0","# Optional: Visualization"
"0","# --------------------------------------------------------------------"
"0","# Heatmap"
"0","library(ggcorrplot)"
"0",""
"0","ggcorrplot(cor_matrix,"
"0","           lab = TRUE,"
"0","           type = ""lower"","
"0","           colors = c(""red"", ""white"", ""blue""),"
"0","           title = ""Correlation Between Deliberation Functions"") +"
"0","  theme_minimal()"
